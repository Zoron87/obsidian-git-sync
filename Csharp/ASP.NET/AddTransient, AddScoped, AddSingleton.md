
**AddSingleton** - создает единственный экземпляр службы при первом запросе и повторно использует этот экземпляр во всех местах, где эта служба необходима. Используется для сервисов, создание экземпляров которых требует больших затрат.

**AddScoped** - при каждом HTTP-запросе мы получаем новый экземпляр службы. Однако в одном и том же HTTP-запросе, если служба требуется в нескольких местах, например, в представлении и в контроллере, то один и тот же экземпляр предоставляется для всей области этого HTTP-запроса. Но каждый новый HTTP-запрос получит новый экземпляр службы. Хорошим кандидатом на роль службы с заданной областью является контекст Entity Framework.
```C#
services.AddScoped<IProductService, ProductService>();
```

**AddTransient** - новый экземпляр представляется каждый раз, когда запрашивается экземпляр службы, независимо от того, находится ли он в области одного и того же HTTP-запроса или в рамках разных HTTP-запросов. Подходит для легких сервисов без сохранения состояния.

Рассмотрим все это на примере:

Представьте, что вы управляете кофейней, и у вас есть три типа сотрудников: бариста, кассиры и менеджеры. Каждый тип сотрудников представляет собой различную зависимость с разным сроком службы в приложении вашей кофейни.

Transient (Бариста):
- подобны найму нового бариста для каждого клиента, который заходит в вашу кофейню.
- Когда приходит клиент, вы нанимаете нового бариста, чтобы тот приготовил ему кофе. После ухода клиента этот бариста больше не нужен и его можно уволить.

```csharp
services.AddTransient<IBarista, Barista>();
```

https://www.youtube.com/watch?v=v6Nr7Zman_Y&list=PL6n9fhu94yhVkdrusLaQsfERmL_Jh4XmU&index=45&ab_channel=kudvenkat

![[Pasted image 20240206154443.png]]