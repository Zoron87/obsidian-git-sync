Шаблон TAP (Task-based Asynchronus Pattern) - основан на библиотеке TPL - Task Parallel Library.
Для работы с шаблоном TAP используется пространство имен System.Threading.Tasks.![[GOM_fFXMfgmbPl.png]]

## Преимущества TAP:

1) Простая инициализация и завершение асинхронной задачи
2)  Удобный способ получения возвращаемого значения асинхронной операции
3)  Получение исключения, возникшего в асинхронной операции, для его обработки
4) Просмотр состояние асинхронной операции
5) Поддержка отмены выполнения (Необязательно)
6) Продолжения задач (Task Continuations)
7)  Планирование выполнения асинхронной операции


## Task

Task (задача) - конструкция, которая реализует модель параллельной обработки, основанной на обещаниях (Promise). Задача обещает, что работа будет выполнена позже, позволяя взаимодействовать с помощью "обещания" с чистым API.
Для работы с задачами в .NET используется класс Task.

### Способы создания задач:

- Создание экземпляра Task и вызов на нем метода Start():
```C#
Task task = new Task(new Action(Download)); - холодная задача
```
- С помощью фабрики задач и метода StartNew(): - считается устаревшим способом
```C#
TaskFactory taskFactory = new TaskFactory();
taskFactory.StartNew(new Action(Download));
```
- Вызов статического метода Task.Run(): - наиболее предпочтительный
```C#
Task.Run(new Action(Download));
```
- Вызов метода RunSynchronously() для выполнения в основном потоке: - похож на первый способ (холодная задача). Выполняем синхронно контексту вызывающего потока. Иногда бывают случаи, когда уже не нужно выполнять асинхронные задачи, тогда мы можем воспользоваться этим методом.
```C#
Task task = new Task(new Action(Download));
task.RunSynchronously();
```
Холодная задача - задача, созданная с помощью команды Task. Она создана, но еще не запущена и ждет отдельной команды на запуск.
Горячая задача - это задача, которая помимо создания еще и сразу же запускается. Обычно создается с помощью специальных методов, например, фабричный метод StartNew() и Task.Run.